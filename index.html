<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<title>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØªØµÙˆÙŠØª - Ø§Ù„Ø¹Ø²ÙŠØ²Ø©</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">

<style>
*,
*::before,
*::after {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: "Cairo", sans-serif;
}

/* Ø®Ù„ÙÙŠØ© Ø¹Ø§Ù…Ø© */
body {
    min-height: 100vh;
    background:
        radial-gradient(circle at top left, rgba(255,255,255,0.14) 0, transparent 55%),
        radial-gradient(circle at bottom right, rgba(0,0,0,0.18) 0, transparent 60%),
        linear-gradient(135deg, #667eea, #764ba2);
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 18px;
    color: #181c32;
}

/* Ø¥Ø®ÙØ§Ø¡ */
.hidden {
    display: none !important;
}

/* Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© */
.container {
    width: 100%;
    max-width: 800px;
    background: #ffffff;
    padding: 38px 26px 28px 26px;
    border-radius: 24px;
    box-shadow:
        0 18px 55px rgba(15, 23, 42, 0.32),
        0 0 0 1px rgba(255, 255, 255, 0.3) inset;
    animation: fadeIn 0.7s cubic-bezier(.4, 0, .2, 1);
    border: 1px solid rgba(226, 232, 255, 0.9);
    position: relative;
    overflow: hidden;
}

.container::before {
    content: "";
    position: absolute;
    inset-inline-start: -90px;
    inset-block-start: -90px;
    width: 180px;
    height: 180px;
    background: radial-gradient(circle, rgba(102, 126, 234, 0.18), transparent 70%);
    opacity: 0.9;
    pointer-events: none;
}

.container::after {
    content: "";
    position: absolute;
    inset-inline-end: -110px;
    inset-block-end: -110px;
    width: 220px;
    height: 220px;
    background: radial-gradient(circle, rgba(118, 75, 162, 0.20), transparent 70%);
    opacity: 0.9;
    pointer-events: none;
}

@keyframes fadeIn {
    0% { opacity: 0; transform: translateY(18px) scale(.98); }
    100% { opacity: 1; transform: translateY(0) scale(1); }
}

/* Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØªØ±Ø­ÙŠØ¨ */
h2#welcome-title {
    position: relative;
    z-index: 1;
    font-size: 2.1em;
    font-weight: 900;
    color: #4338ca;
    text-align: center;
    margin-bottom: 20px;
    letter-spacing: 0.5px;
}

h2#welcome-title::after {
    content: "";
    display: block;
    width: 90px;
    height: 4px;
    border-radius: 999px;
    margin: 8px auto 0;
    background: linear-gradient(90deg, #667eea, #a855f7);
}

/* ØµÙ†Ø¯ÙˆÙ‚ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù„Ø¬Ù†Ø© */
.committee-info {
    position: relative;
    z-index: 1;
    background: linear-gradient(90deg, #eef2ff 0%, #e0f2fe 100%);
    padding: 14px 16px;
    text-align: center;
    border-radius: 16px;
    border-right: 4px solid #4f46e5;
    margin-bottom: 20px;
    box-shadow: 0 8px 22px rgba(15, 23, 42, 0.09);
}

#committee-name-display {
    font-size: 1.15em;
    font-weight: 800;
    color: #1e293b;
    margin-bottom: 4px;
}

#committee-address-display {
    font-size: 0.95em;
    color: #475569;
}

/* Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ø­Ù‚ÙˆÙ„ */
label {
    display: block;
    position: relative;
    z-index: 1;
    color: #4b5563;
    font-weight: 700;
    margin-top: 18px;
    margin-bottom: 6px;
    font-size: 1.02em;
}

/* Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ */
input[type="text"],
input[type="password"] {
    width: 100%;
    padding: 12px 14px;
    border-radius: 12px;
    border: 1.3px solid #cbd5f5;
    background: #f9fafb;
    margin-bottom: 4px;
    font-size: 1.03em;
    color: #111827;
    transition: border-color .18s ease, box-shadow .18s ease, background .18s ease;
}

input[type="text"]::placeholder,
input[type="password"]::placeholder {
    color: #9ca3af;
    font-size: 0.96em;
}

input[type="text"]:focus,
input[type="password"]:focus {
    border-color: #6366f1;
    background: #f5f3ff;
    outline: none;
    box-shadow: 0 0 0 1px rgba(99, 102, 241, 0.15);
}

/* Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø±Ø´Ø­ÙŠÙ† */
.candidate-list {
    position: relative;
    z-index: 1;
    margin-top: 6px;
    background: #f3f4ff;
    border: 1.5px solid #e0e7ff;
    border-radius: 18px;
    max-height: 46vh;
    overflow-y: auto;
    padding: 10px;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 9px;
}

/* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ…Ø±ÙŠØ± */
.candidate-list::-webkit-scrollbar {
    width: 6px;
}
.candidate-list::-webkit-scrollbar-track {
    background: transparent;
}
.candidate-list::-webkit-scrollbar-thumb {
    background: #a5b4fc;
    border-radius: 999px;
}

/* Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…Ø±Ø´Ø­ */
.candidate-item {
    background: #ffffff;
    border: 1.4px solid #e5e7ff;
    padding: 11px 9px;
    border-radius: 14px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    cursor: pointer;
    user-select: none;
    box-shadow: 0 6px 15px rgba(148, 163, 255, 0.30);
    font-size: 0.98em;
    position: relative;
    overflow: hidden;
    transition: background .18s ease, color .18s ease, transform .1s ease, box-shadow .18s ease, border-color .18s ease;
}

.candidate-item:hover {
    transform: translateY(-1px);
    box-shadow: 0 10px 24px rgba(79, 70, 229, 0.27);
}

.candidate-item.selected {
    background: linear-gradient(115deg, #4f46e5, #7c3aed);
    color: #ffffff;
    border-color: transparent;
    box-shadow: 0 10px 28px rgba(76, 81, 191, 0.52);
}

/* Ø¯Ø§Ø¦Ø±Ø© Ø±Ù‚Ù… Ø§Ù„Ù…Ø±Ø´Ø­ */
.num-circle {
    width: 32px;
    height: 32px;
    background: #eef2ff;
    color: #4f46e5;
    font-weight: 800;
    font-size: 0.98em;
    border-radius: 50%;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    margin-left: 10px;
    flex-shrink: 0;
    transition: background .18s ease, color .18s ease, transform .18s ease;
}

.candidate-item.selected .num-circle {
    background: rgba(255, 255, 255, 0.18);
    color: #ffffff;
    transform: scale(1.02);
}

/* Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ */
.candidate-item > div:last-child {
    font-size: 1.3em;
}

/* Ø¥Ø®ÙØ§Ø¡ ØªØ´ÙŠÙƒ Ø¨ÙˆÙƒØ³ Ø§Ù„Ù…Ø±Ø´Ø­ */
.candidate-checkbox {
    display: none;
}

/* Ù…Ø±Ø¨Ø¹ Ø­Ø§Ù„Ø© Ø§Ù„ØµÙˆØª */
.sec-box {
    position: relative;
    z-index: 1;
    background: #f8fafc;
    border: 1.6px solid #e2e8f0;
    border-radius: 16px;
    padding: 14px 14px 16px 14px;
    margin-top: 20px;
    box-shadow: 0 6px 18px rgba(148, 163, 184, 0.18);
    font-size: 0.97em;
    color: #0f172a;
}

.sec-box > span {
    display: block;
    margin-bottom: 10px;
    font-weight: 700;
}

/* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø±Ø§Ø¯ÙŠÙˆ */
.radio-group {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
}

.radio-item {
    padding: 11px 10px;
    border: 1.7px solid #d4d4ff;
    border-radius: 12px;
    cursor: pointer;
    text-align: center;
    font-weight: 700;
    color: #1f2933;
    background: #ffffff;
    box-shadow: 0 3px 12px rgba(148, 163, 255, 0.35);
    transition: background .18s ease, color .18s ease, border-color .18s ease, transform .08s ease, box-shadow .18s ease;
    font-size: 0.97em;
}

.radio-item:hover {
    transform: translateY(-0.5px);
    box-shadow: 0 6px 18px rgba(129, 140, 248, 0.6);
}

.radio-item.selected {
    background: linear-gradient(120deg, #22c55e, #16a34a);
    color: #ffffff;
    border-color: transparent;
    box-shadow: 0 9px 22px rgba(22, 163, 74, 0.5);
}

/* Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø£Ø²Ø±Ø§Ø± ÙÙŠ Ø£Ø³ÙÙ„ Ø§Ù„ÙÙˆØ±Ù… */
.button-row {
    display: flex;
    gap: 10px;
    margin-top: 22px;
    position: relative;
    z-index: 1;
}

button {
    font-family: "Cairo", sans-serif;
}

/* Ø²Ø± Ø£Ø³Ø§Ø³ÙŠ */
.btn-primary,
.btn-reset,
.btn-logout {
    flex: 1;
    padding: 12px 10px;
    border-radius: 12px;
    border: none;
    font-weight: 800;
    font-size: 0.96em;
    cursor: pointer;
    transition: background .15s ease, transform .08s ease, box-shadow .15s ease, color .15s ease;
}

/* ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØªØµÙˆÙŠØª */
.btn-primary {
    background: linear-gradient(135deg, #4f46e5, #7c3aed);
    color: #ffffff;
    box-shadow: 0 10px 24px rgba(76, 81, 191, 0.65);
}

.btn-primary:hover {
    transform: translateY(-1px);
    box-shadow: 0 14px 28px rgba(76, 81, 191, 0.85);
}

.btn-primary:disabled {
    opacity: 0.7;
    cursor: wait;
    box-shadow: none;
}

/* ØªÙØ±ÙŠØº */
.btn-reset {
    background: #e0f2fe;
    color: #0369a1;
    box-shadow: 0 6px 18px rgba(56, 189, 248, 0.50);
}

.btn-reset:hover {
    transform: translateY(-1px);
    background: #bae6fd;
    box-shadow: 0 8px 22px rgba(37, 99, 235, 0.5);
}

/* Ø®Ø±ÙˆØ¬ */
.btn-logout {
    background: #fee2e2;
    color: #b91c1c;
    box-shadow: 0 6px 18px rgba(239, 68, 68, 0.45);
}

.btn-logout:hover {
    transform: translateY(-1px);
    background: #fecaca;
    box-shadow: 0 8px 22px rgba(220, 38, 38, 0.7);
}

/* Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØªØ­Ø°ÙŠØ± ÙˆØ§Ù„ØªØ£ÙƒÙŠØ¯ */
#msg-warn,
#msg-confirm {
    position: relative;
    z-index: 1;
    text-align: center;
    margin-top: 10px;
    font-weight: 700;
    font-size: 0.95em;
}

#msg-warn {
    color: #b91c1c;
}

#msg-confirm {
    color: #15803d;
}

/* Ø´Ø§Ø´Ø© ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± */
#login-box {
    position: fixed;
    inset: 0;
    background:
        radial-gradient(circle at top, rgba(255,255,255,0.28), transparent 55%),
        linear-gradient(135deg, #1d2671, #c33764);
    z-index: 9999999;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 18px;
}

.login-card {
    background: rgba(15, 23, 42, 0.86);
    padding: 26px 22px 20px 22px;
    border-radius: 18px;
    width: 90%;
    max-width: 360px;
    text-align: center;
    color: #e5e7eb;
    box-shadow: 0 18px 45px rgba(15, 23, 42, 0.9);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(148, 163, 184, 0.6);
}

.login-card h3 {
    margin-bottom: 12px;
    font-weight: 800;
    font-size: 1.2em;
}

.login-card p {
    font-size: 0.9em;
    color: #cbd5f5;
    margin-bottom: 10px;
}

/* Ù…Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø¯Ø§Ø®Ù„ Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ */
.login-card input[type="password"] {
    background: rgba(15, 23, 42, 0.9);
    border-color: #4b5563;
    color: #e5e7eb;
}

/* Ø²Ø± Ø§Ù„Ø¯Ø®ÙˆÙ„ */
#pass-btn {
    width: 100%;
    margin-top: 6px;
    background: linear-gradient(135deg, #4f46e5, #9333ea);
    color: #ffffff;
    border: none;
    border-radius: 11px;
    font-weight: 800;
    padding: 12px;
    cursor: pointer;
    box-shadow: 0 10px 26px rgba(59, 130, 246, 0.7);
}

#pass-btn:hover {
    transform: translateY(-1px);
    box-shadow: 0 15px 30px rgba(59, 130, 246, 0.95);
}

#pass-error {
    margin-top: 8px;
    color: #fecaca;
    font-size: 0.9em;
}

/* Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
@media (max-width: 640px) {
    .container {
        padding: 26px 18px 20px 18px;
        border-radius: 20px;
    }
    h2#welcome-title {
        font-size: 1.6em;
    }
    .committee-info {
        padding-inline: 10px;
        font-size: 0.95em;
    }
    .candidate-list {
        grid-template-columns: 1fr;
        max-height: 52vh;
    }
    .button-row {
        flex-direction: column;
    }
    .btn-primary,
    .btn-reset,
    .btn-logout {
        width: 100%;
    }
}
</style>
</head>

<body>

<!-- Ø´Ø§Ø´Ø© ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± -->
<div id="login-box">
  <div class="login-card">
    <h3>ğŸ” Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±</h3>
    <p>Ù…Ø®ØµØµ Ù„Ø£ÙØ±Ø§Ø¯ Ù„Ø¬Ù†Ø© Ø§Ù„Ø¹Ø²ÙŠØ²Ø© ÙÙ‚Ø·</p>
    <input id="pass-input" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
    <button id="pass-btn">Ø¯Ø®ÙˆÙ„</button>
    <p id="pass-error" style="display:none;"></p>
  </div>
</div>

<div class="container hidden" id="main-container">
  <h2 id="welcome-title">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØªØµÙˆÙŠØª - Ø§Ù„Ø¹Ø²ÙŠØ²Ø©</h2>

  <div class="committee-info">
    <div id="committee-name-display">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
    <div id="committee-address-display">Ù…Ø¯Ø±Ø³Ø© Ù…Ø¬Ù…Ø¹ Ø§Ù„Ø¹Ø²ÙŠØ²Ø© Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠØ©</div>
  </div>

  <form id="vote-form">
    <label>Ø§Ø³Ù… Ø§Ù„Ù†Ø§Ø®Ø¨ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ):</label>
    <input type="text" id="voter-name" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø§Ø³Ù… Ù‡Ù†Ø§...">

    <label>Ø§Ø®ØªØ± Ø§Ù„Ù…Ø±Ø´Ø­ (Ø­Ø¯ Ø£Ù‚ØµÙ‰ 2):</label>
    <div id="candidate-list" class="candidate-list"></div>

    <div class="sec-box">
        <span>Ø­Ø§Ù„Ø© Ø§Ù„ØµÙˆØª:</span>
        <div class="radio-group">
            <label class="radio-item">
              <input type="radio" name="vvalid" value="ØµØ­ÙŠØ­" hidden> âœ“ ØµØ­ÙŠØ­
            </label>
            <label class="radio-item">
              <input type="radio" name="vvalid" value="Ø¨Ø§Ø·Ù„" hidden> âœ— Ø¨Ø§Ø·Ù„
            </label>
        </div>
    </div>

    <div class="button-row">
      <button type="submit" class="btn-primary">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØªØµÙˆÙŠØª</button>
      <button type="reset" class="btn-reset">ØªÙØ±ÙŠØº</button>
      <button type="button" class="btn-logout">Ø®Ø±ÙˆØ¬</button>
    </div>

    <div id="msg-warn" style="display:none;"></div>
    <div id="msg-confirm" style="display:none;"></div>
  </form>
</div>

<script>
// -------------------- Ù†Ø¸Ø§Ù… ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± --------------------
document.getElementById("pass-btn").addEventListener("click", () => {
  const pass = document.getElementById("pass-input").value.trim();
  const err = document.getElementById("pass-error");

  if (pass === "ma100124") {
      // Ø±Ø¬Ø§Ù„ -> Ù„Ø¬Ù†Ø© 24
      localStorage.setItem("committee", "men");
      location.reload();
  }
  else if (pass === "wa100125") {
      // Ù†Ø³Ø§Ø¡ -> Ù„Ø¬Ù†Ø© 25
      localStorage.setItem("committee", "women");
      location.reload();
  }
  else {
      err.textContent = "âŒ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± ØºÙŠØ± ØµØ­ÙŠØ­Ø©";
      err.style.display = "block";
  }
});
</script>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getDatabase, ref, set } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";
import { getAuth, signOut } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";

// Firebase
const firebaseConfig = {
  apiKey: "AIzaSyBmgHAmoZKm2RRXg42KWdQHD4e5hAUtBbc",
  authDomain: "azizaonly-2ab60.firebaseapp.com",
  databaseURL: "https://azizaonly-2ab60-default-rtdb.firebaseio.com",
  projectId: "azizaonly-2ab60",
  storageBucket: "azizaonly-2ab60.appspot.com",
  messagingSenderId: "447237336190",
  appId: "1:447237336190:web:eab8a2b524b0dcdd5a3c2f"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const auth = getAuth(app);

// -------------------- Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù„Ø¬Ù†Ø© Ù…Ù† localStorage --------------------
const committeeType = localStorage.getItem("committee");

if (!committeeType) {
    // Ù„Ù… ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    document.getElementById("main-container").classList.add("hidden");
    document.getElementById("login-box").style.display = "flex";
    throw "NO_LOGIN";
}

let committeeNumber = 0;
let committeeName = "";

if (committeeType === "men") {
  committeeNumber = 24;
  committeeName = "Ù…Ø¬Ù…Ø¹ Ø§Ù„Ø¹Ø²ÙŠØ²Ø© - Ù„Ø¬Ù†Ø© Ø§Ù„Ø±Ø¬Ø§Ù„";
} else {
  committeeNumber = 25;
  committeeName = "Ù…Ø¬Ù…Ø¹ Ø§Ù„Ø¹Ø²ÙŠØ²Ø© - Ù„Ø¬Ù†Ø© Ø§Ù„Ù†Ø³Ø§Ø¡";
}

document.getElementById("committee-name-display").textContent = committeeName;
document.getElementById("welcome-title").textContent = "Ø§Ù„Ù„Ø¬Ù†Ø© Ø±Ù‚Ù… " + committeeNumber;

// Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØµÙØ­Ø©
document.getElementById("login-box").style.display = "none";
document.getElementById("main-container").classList.remove("hidden");

// -------------------- Ø§Ù„Ù…Ø±Ø´Ø­ÙˆÙ† --------------------
const candidates = [
  ["1","Ø§ÙŠÙ‡Ø§Ø¨ Ø§Ù„Ø¹Ù…Ø¯Ù‡","ğŸ‘‘"],["2","Ù…Ø­Ù…Ø¯ Ø§Ù„Ø¹ØªÙ…Ø§Ù†Ù‰","ğŸ"],["3","Ø£Ø­Ù…Ø¯ Ø§Ù„Ø­Ø¯ÙŠØ¯Ù‰","ğŸ¦"],
  ["4","Ø¹Ø§Ø¯Ù„ Ø§Ù„Ø¬ÙŠØ§Ø±","ğŸ¦…"],["5","Ø§Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø³Ù…Ø±Ù‡","ğŸ’£"],["6","ÙˆÙ„ÙŠØ¯ ØªÙŠØ³ÙŠØ± Ø§Ù„Ø§Ù…ÙŠØ±","ğŸŠ"],
  ["7","ÙƒÙ…Ø§Ù„ Ø§Ù„Ø¹ÙŠØ³ÙˆÙ‰","ğŸŒ€"],["8","Ø§Ù„Ø¨Ø¯ÙˆÙ‰ Ø¬Ù…ÙŠØ²","ğŸ‹"],["9","Ø§Ø­Ù…Ø¯ Ø§Ù„Ø±ÙŠØ³","ğŸ¦‚"],
  ["10","Ø£Ø­Ù…Ø¯ Ø¹ÙˆÙ","âœ‹"],["11","Ø­Ø³Ù† Ø§Ù„Ù…Ù„Ù‡Ø§Ø·","ğŸŒ¿"],["12","Ø¹Ù…Ø±Ùˆ Ù…Ø­Ù…Ø¯ Ø¨Ø­ÙŠØ±Ù‰","ğŸšŒ"],
  ["13","Ø§Ù„Ø³ÙŠØ¯ Ø·Ù…Ø§Ù†","ğŸ”«"],["14","Ù…Ø­Ù…Ø¯ Ø¯Ù†Ø¯Ù†","ğŸš"],["15","Ù…Ø¬Ø¯Ù‰ Ø§Ù„Ø£Ù…ÙŠØ±","ğŸ–Š"]
];

const listBox = document.getElementById("candidate-list");

candidates.forEach(c => {
  const item = document.createElement("div");
  item.className = "candidate-item";

  const checkbox = document.createElement("input");
  checkbox.type = "checkbox";
  checkbox.value = c[1];
  checkbox.className = "candidate-checkbox";

  item.innerHTML = `
    <div style="display:flex;align-items:center;gap:8px;">
        <div class="num-circle">${c[0]}</div>
        <span>${c[1]}</span>
    </div>
    <div>${c[2]}</div>
  `;

  item.appendChild(checkbox);

  // Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©
  item.addEventListener("click", (e) => {
      if (e.target !== checkbox) checkbox.checked = !checkbox.checked;
      updateSelection();
  });

  // Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„ØªØ´ÙŠÙƒ Ø¨ÙˆÙƒØ³ Ù…Ø¨Ø§Ø´Ø±Ø©Ù‹
  checkbox.addEventListener("change", updateSelection);

  listBox.appendChild(item);
});

function updateSelection(){
  const checked = document.querySelectorAll(".candidate-checkbox:checked");
  if (checked.length > 2) {
      checked[checked.length - 1].checked = false;
      showWarn("âš ï¸ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø±Ø´Ø­ÙŠÙ† ÙÙ‚Ø·");
  }
  document.querySelectorAll(".candidate-item").forEach(item => {
      const cb = item.querySelector("input");
      item.classList.toggle("selected", cb.checked);
  });
}

// ØªØ¸Ù„ÙŠÙ„ Ø­Ø§Ù„Ø© Ø§Ù„ØµÙˆØª
document.querySelectorAll("input[name='vvalid']").forEach(r => {
  r.addEventListener("change", () => {
    document.querySelectorAll(".radio-item").forEach(x => x.classList.remove("selected"));
    r.closest(".radio-item").classList.add("selected");
  });
});

// Ø±Ø³Ø§Ø¦Ù„
function showWarn(msg){
  const b = document.getElementById("msg-warn");
  b.textContent = msg;
  b.style.display = "block";
  setTimeout(() => b.style.display = "none", 2600);
}

function showConfirm(msg){
  const b = document.getElementById("msg-confirm");
  b.textContent = msg;
  b.style.display = "block";
  setTimeout(() => b.style.display = "none", 3000);
}

// Ø­ÙØ¸ Ø§Ù„ØªØµÙˆÙŠØª
document.getElementById("vote-form").addEventListener("submit", e => {
  e.preventDefault();

  let voterName = document.getElementById("voter-name").value.trim();
  if (!voterName) voterName = "Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…";

  const selected = Array.from(
      document.querySelectorAll(".candidate-checkbox:checked")
  ).map(x => x.value);

  const validity = document.querySelector("input[name='vvalid']:checked");

  if (selected.length < 1) return showWarn("â— Ø§Ø®ØªØ± Ù…Ø±Ø´Ø­ ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„");
  if (!validity) return showWarn("â— Ø§Ø®ØªØ± Ø­Ø§Ù„Ø© Ø§Ù„ØµÙˆØª");

  const btn = document.querySelector(".btn-primary");
  btn.disabled = true;
  btn.textContent = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸...";

  const key = Date.now();
  set(ref(db, "votes/aziza/" + key), {
      name: voterName,
      selected: selected,
      vote_validity: validity.value,
      committee: committeeNumber,
      timestamp: key
  })
  .then(() => {
      showConfirm("âœ… ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­!");
      document.getElementById("vote-form").reset();
      document.querySelectorAll(".candidate-item").forEach(i => i.classList.remove("selected"));
      document.querySelectorAll(".radio-item").forEach(i => i.classList.remove("selected"));
  })
  .catch(err => showWarn("âŒ Ø®Ø·Ø£: " + err.message))
  .finally(() => {
      btn.disabled = false;
      btn.textContent = "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØªØµÙˆÙŠØª";
  });
});

// Ø®Ø±ÙˆØ¬
document.querySelector(".btn-logout").addEventListener("click", () => {
  localStorage.removeItem("committee");
  location.reload();
});
</script>

</body>
</html>
